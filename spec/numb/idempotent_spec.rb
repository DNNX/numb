# coding: utf-8
describe Integer, "#idempotent" do

  @seq = {
    # A000027
    1 => [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,
          20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,
          36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,
          52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,
          68,69,70,71,72,73,74,75,76,77],
    # A001788      
    2 => [0,1,6,24,80,240,672,1792,4608,11520,28160,67584,
          159744,372736,860160,1966080,4456448,10027008,
          22413312,49807360,110100480,242221056,530579456,
          1157627904,2516582400,5452595200,11777605632].reject(&:zero?),
    # A036216
    3 => [1,12,90,540,2835,13608,61236,262440,1082565,
          4330260,16888014,64481508,241805655,892820880,
          3252418920,11708708112,41712272649,147219785820,
          515269250370,1789882659180,6175095174171,
          21171754882872],
    # A040075
    4 => [1,20,240,2240,17920,129024,860160,5406720,
          32440320,187432960,1049624576,5725224960,
          30534533120,159719096320,821412495360,
          4161823309824,20809116549120,102821517066240,
          502682972323840],
    # A050982      
    5 => [1,30,525,7000,78750,787500,7218750,61875000,
          502734375,3910156250,29326171875,213281250000,
          1510742187500,10458984375000,70971679687500,
          473144531250000,3105010986328125,
          20091247558593750],
    # A050988
    6 => [1,42,1008,18144,272160,3592512,43110144,
          480370176,5043886848,50438868480,484213137408,
          4489976365056,40409787285504,354362750042112,
          3037395000360960,25514118003032064],
    # A050989      
    7 => [1,56,1764,41160,792330,13311144,201885684,
          2826399576,37096494435,461645264080,5493578642552,
          62926446269232,697434779483988,7510836086750640,
          78863778910881720,809668130151718992],
  }

  @seq.each do |n, values|
    (1...n).each do |k|
      it "returns 0 when n=#{n} and k=#{k}" do
        n.idempotent(k).should be_zero
      end
    end

    values.to_enum.with_index(n).each do |idem, k|
      it "returns #{idem} for n=#{n} and k=#{k}" do
        n.idempotent(k).should == idem
      end
    end
  end
end
